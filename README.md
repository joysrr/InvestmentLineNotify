# 00675L 槓桿 ETF 投資決策系統

## 📖 系統概述

這是一套基於技術指標的自動化投資決策系統，專門設計用於 0050 + 00675L（元大台灣50正2）的槓桿投資策略。系統採用「收盤後決策 + 隔日手動執行」模式，結合多重技術指標與風控機制，提供每日投資建議。

### 核心特色

- ✅ **趨勢跟蹤策略**：基於 RSI、KD、MACD、年線乖離率等技術指標
- ✅ **多層次風控**：維持率監控、佔比再平衡、過熱偵測
- ✅ **評分制進場**：累積多個訊號達標才觸發買入
- ✅ **極端恐慌買入**：VIX + 極度超賣時自動觸發逆向加碼
- ✅ **配置驅動**：所有門檻參數透過 `Strategy.json` 集中管理

### ⚠️ 重要聲明

> **本系統僅供個人投資參考，不構成投資建議。**
> 
> - 槓桿投資風險極高，可能導致本金全部損失
> - 過去績效不代表未來表現
> - 使用者需自行承擔所有投資風險
> - 建議僅投入可承受損失的資金

## 🚀 快速開始

### 第一次使用
1. ✅ 閱讀「策略邏輯」了解決策流程
2. ✅ 檢查 `Strategy.json` 參數設定
3. ✅ 設定 GitHub Actions 定時執行
4. ✅ 測試 LINE 通知是否正常
5. ✅ 小額測試執行流程（建議 1-2 週）

### 每日操作（3 分鐘）
1. **14:40** 收到通知 → 檢查決策（1 分鐘）
2. **08:30** 收到提醒 → 準備執行（1 分鐘）
3. **09:05** 開盤檢查 → 執行下單（1 分鐘）

---

## 🎯 策略邏輯

### 決策優先級（由高到低）

```
1. 🧯 追繳風險      維持率 < 140%  →  停止撥款，優先補保證金
2. ⚖️ 再平衡        00675L 佔比 > 45%  →  賣出還款，回到 40%
3. 💸 停利/降槓桿    漲幅 >= 80% + 賣出訊號 >= 2  →  賣出降槓桿
4. 💰 恐慌加碼      跌幅 >= 30% + RSI < 25 + VIX >= 28  →  逆向加碼
5. 🚫 禁撥款        過熱因子 >= 2  →  0050照常，00675L禁撥
6. 📉 轉弱監控      轉弱訊號 >= 3  →  停止加碼
7. 🌡️ 偏熱/觀察     分數不足但有過熱跡象  →  不撥款
8. 👀 觀察/未達進場  分數 < 4 或跌幅不足  →  等待
9. 🚀 轉多/可進攻    分數 >= 10  →  大額加碼（60%）
10. 📈 轉多/可加碼   分數 >= 8   →  積極加碼（50%）
11. 🛡️ 常態布局     分數 >= 4   →  定期定額（40%）
```
---

## ⚙️ Strategy.json 設定檔詳解

### 1. 槓桿設定 (`leverage`)

```json
{
  "targetMultiplier": 1.8
}
```

| 參數 | 說明 | 預設值 |
|:---|:---|---:|
| `targetMultiplier` | 目標槓桿倍數（00675L 本身已是 2 倍槓桿） | 1.8 |

**計算邏輯**：
- 實際槓桿 = (總資產) / (淨資產)
- 目標是買入後整體投資組合達到 1.8 倍槓桿

---

### 2. 買入條件 (`buy`)

#### 2.1 基本門檻

```json
{
  "minDropPercentToConsider": 0,
  "minWeightScoreToBuy": 4
}
```

| 參數 | 說明 | 預設值 | 調整建議 |
|:---|:---|---:|:---|
| `minDropPercentToConsider` | 最低考慮跌幅（%） | 0 | 任何跌幅都考慮 |
| `minWeightScoreToBuy` | 最低買入評分 | 4 | 調高 → 更保守；調低 → 更激進 |

#### 2.2 跌幅評分規則 (`dropScoreRules`)

```json
[
  { "minDrop": 40, "score": 8, "label": "毀滅 >= 40%" },
  { "minDrop": 30, "score": 6, "label": "恐慌 >= 30%" },
  { "minDrop": 20, "score": 5, "label": "大跌 >= 20%" },
  { "minDrop": 15, "score": 4, "label": "修正 >= 15%" },
  { "minDrop": 10, "score": 3, "label": "波動 >= 10%" }
]
```

**計算邏輯**：從高到低匹配，取第一個符合的分數

**調整範例**：
```json
// 更激進：降低門檻
{ "minDrop": 8, "score": 3, "label": "小跌 >= 8%" }

// 更保守：提高門檻
{ "minDrop": 50, "score": 10, "label": "崩盤 >= 50%" }
```

#### 2.3 技術指標評分

```json
{
  "rsi": {
    "oversold": 40,  // RSI 超賣門檻
    "score": 3       // 觸發時得分
  },
  "macd": {
    "score": 2       // MACD 黃金交叉得分
  },
  "kd": {
    "oversoldK": 20, // KD 超賣門檻
    "score": 2       // KD 低檔交叉得分
  }
}
```

**總分計算**：
```
總分 = 跌幅分數 + RSI分數 + MACD分數 + KD分數
範圍：0 ~ 15 分（理論最高）
```

**調整指引**：
- RSI 門檻越低 → 越保守（等更超賣才買）
- 分數越高 → 該指標權重越大

#### 2.4 極端恐慌買入 (`panic`)

```json
{
  "minDropRank": 2,           // 跌幅取第 2 高級別（恐慌30%）
  "rsiDivider": 1.6,          // RSI門檻除數（40/1.6=25）
  "minVixLevel": "panic",     // VIX 最低級別要求
  "suggestedLeverage": 0.3    // 建議槓桿比例（30%）
}
```

**觸發條件**：
```javascript
跌幅 >= 30% (第2高級別)
  AND RSI < 25 (40/1.6)
  AND VIX >= 28 (threshold.vixPanic)
→ 建議逆向加碼，槓桿 30%
```

---

### 3. 賣出條件 (`sell`)

```json
{
  "postAllocationIndexFromEnd": 2,  // 停利後回到倒數第2配置
  "minUpPercentToSell": 80,         // 最低漲幅門檻
  "minSignalCountToSell": 2,        // 最低賣出訊號數
  "rsi": {
    "overbought": 75                // RSI 超買門檻
  },
  "kd": {
    "overboughtK": 80               // KD 超買門檻
  }
}
```

**觸發條件**：
```
漲幅 >= 80%
  AND 賣出訊號 >= 2 個（RSI回落、MACD死叉、KD高檔死叉）
→ 賣出還款，降至槓桿 60%（allocation[1])
```

**賣出訊號**：
1. **RSI 回落**：RSI 從超買區（>75）回落
2. **MACD 死叉**：快線下穿慢線，柱狀圖轉負
3. **KD 高檔死叉**：KD 在高檔（>80）死叉或 %D 跌破 80

---

### 4. 資產配置 (`allocation`)

```json
[
  { "minScore": 10, "leverage": 0.8, "cash": 0.2, "comment": "槓桿全開(1.8x)" },
  { "minScore": 8,  "leverage": 0.6, "cash": 0.4, "comment": "積極加碼(1.6x)" },
  { "minScore": 6,  "leverage": 0.4, "cash": 0.6, "comment": "一般訊號(1.4x)" },
  { "minScore": 4,  "leverage": 0.2, "cash": 0.8, "comment": "微量/觀察(1.2x)" },
  { "minScore": -99,"leverage": 0,   "cash": 1.0, "comment": "平時/底倉(1.0x)" }
]
```

**說明**：
- `minScore`：達到此評分時使用此配置
- `leverage`：00675L 槓桿佔淨資產比例
- `cash`：現金佔淨資產比例
- `leverage + cash = 1.0`

**實際槓桿倍數**：
```
實際槓桿 = 1 + leverage * 目標倍數
例：leverage=0.8, targetMultiplier=1.8
  → 實際槓桿 = 1 + 0.8 * 1.8 = 2.44x
```

---

### 5. 風控門檻 (`threshold`)

#### 5.1 風控與再平衡

```json
{
  "z2TargetRatio": 0.4,           // 00675L 目標佔比 40%
  "z2RatioHigh": 45,              // 00675L 超標門檻 45%
  "mmDanger": 140,                // 追繳風險門檻 140%
  "minActionableAmount": 10000,   // 最小操作金額 1萬
  "reversalTriggerCount": 3       // 轉弱觸發數量
}
```

| 參數 | 說明 | 預設值 | 風險提示 |
|:---|:---|---:|:---|
| `z2TargetRatio` | 目標佔比 | 40% | 再平衡目標值 |
| `z2RatioHigh` | 超標門檻 | 45% | 超過時賣出還款 |
| `mmDanger` | 追繳風險 | 140% | 低於時停止撥款 |
| `reversalTriggerCount` | 轉弱數量 | 3 | 4個指標中觸發3個 |

#### 5.2 過熱門檻（Overheat State）

```json
{
  "overheatCount": 2,             // 至少2個因子觸發
  "rsiOverheatLevel": 82,         // RSI 過熱門檻
  "dOverheatLevel": 85,           // KD %D 過熱門檻
  "bias240OverheatLevel": 35      // 年線乖離率過熱門檻
}
```

**觸發邏輯**：
```javascript
過熱因子 = [
  RSI > 82 ❌,
  KD %D > 85 ❌,
  年線乖離率 > 35% ❌
]

若 觸發數 >= 2 → 🚫 禁撥款
```

#### 5.3 轉弱門檻（Reversal Triggers）

```json
{
  "rsiReversalLevel": 60,  // RSI 跌破此值視為轉弱
  "kReversalLevel": 75     // KD 跌破此值視為轉弱
}
```

**轉弱訊號**（4個）：
1. RSI 從高位跌破 60
2. KD 最小值跌破 75
3. KD 死叉（K 下穿 D）
4. MACD 死叉

**觸發條件**：4個訊號中 >= 3個觸發 → 📉 停止加碼

#### 5.4 進場級別門檻

```json
{
  "wAggressive": 10,  // 最積極型門檻（60% 槓桿）
  "wActive": 8        // 積極型門檻（50% 槓桿）
}
```

**決策對應**：
- 分數 >= 10 → 🔥 最積極型（60%）
- 分數 >= 8 → 📈 積極型（50%）
- 分數 >= 4 → 🛡️ 定期定額（40%）

#### 5.5 VIX 門檻

```json
{
  "vixLowComplacency": 12,  // 恐慌指數過低（市場自滿）
  "vixHighFear": 20,        // 開始恐慌
  "vixPanic": 28,           // 恐慌（觸發逆向買入）
  "vixExtreme": 35,         // 極端恐慌（加大買入）
  "usVixPanic": 30          // 美國VIX恐慌門檻
}
```

**VIX 分級**：
- < 12：市場過度樂觀（警戒）
- 12-20：正常
- 20-28：開始恐慌
- >= 28：恐慌買入訊號
- >= 35：極端恐慌（建議更高槓桿）

---

## 🔍 判斷邏輯決策樹

```
收到今日收盤資料
    │
    ├─ 維持率 < 140%? ────────────→ 🧯 追繳風險（停止撥款）
    │
    ├─ 00675L 佔比 > 45%? ────────→ ⚖️ 再平衡（賣出還款）
    │
    ├─ 漲幅>=80% + 賣出訊號>=2? ──→ 💸 停利/降槓桿
    │
    ├─ 跌幅>=30% + RSI<25 + VIX>=28? → 💰 恐慌加碼
    │
    ├─ 過熱因子 >= 2? ────────────→ 🚫 禁撥款
    │
    ├─ 轉弱訊號 >= 3? ────────────→ 📉 轉弱監控（停止加碼）
    │
    ├─ 分數不足 + 有過熱跡象? ────→ 🌡️ 偏熱/觀察
    │
    ├─ 分數 < 4 或跌幅不足? ──────→ 👀 觀察/未達進場
    │
    └─ 計算評分
        │
        ├─ 分數 >= 10 ──────────→ 🔥 最積極型（60%）
        ├─ 分數 >= 8 ───────────→ 📈 積極型（50%）
        └─ 分數 >= 4 ───────────→ 🛡️ 定期定額（40%）
```

---

## 📊 評分系統範例

### 情境 A：修正買點（分數 9）

```
跌幅：16% → 4 分（修正 >= 15%）
RSI：38 → 3 分（從 >40 反轉）
MACD：黃金交叉 → 2 分
KD：低檔交叉 → 0 分（未達標）
━━━━━━━━━━━━━━━
總分：9 分 → 📈 積極型（50% 槓桿）
```

### 情境 B：恐慌買點（分數 13）

```
跌幅：32% → 6 分（恐慌 >= 30%）
RSI：35 → 3 分
MACD：黃金交叉 → 2 分
KD：低檔交叉 → 2 分
VIX：31 → 💰 觸發恐慌加碼
━━━━━━━━━━━━━━━
總分：13 分 + 恐慌買入（建議 30% 槓桿）
```

### 情境 C：未達門檻（分數 3）

```
跌幅：8.3% → 0 分（未達 10%）
RSI：56.6 → 0 分（未超賣）
MACD：無交叉 → 0 分
KD：74.7 → 0 分（太高）
━━━━━━━━━━━━━━━
總分：3 分 < 4 → 👀 觀察/不撥款
```

---

## 🛠️ 參數調整指南

### 1. 如果經常錯過機會（太保守）

```json
// 降低買入門檻
"minWeightScoreToBuy": 3  // 從 4 降到 3

// 增加小跌幅規則
"dropScoreRules": [
  { "minDrop": 8, "score": 2, "label": "小跌 >= 8%" },
  // ... 其他規則
]

// 提高 RSI 超賣門檻
"rsi": {
  "oversold": 45  // 從 40 提高到 45
}
```

### 2. 如果經常追高（太激進）

```json
// 提高買入門檻
"minWeightScoreToBuy": 5  // 從 4 提高到 5

// 提高跌幅要求
"minDropPercentToConsider": 5  // 至少跌 5% 才考慮

// 降低 RSI 超賣門檻
"rsi": {
  "oversold": 35  // 從 40 降到 35（等更超賣）
}
```

### 3. 如果想提早止盈

```json
// 降低停利門檻
"minUpPercentToSell": 60  // 從 80% 降到 60%

// 降低賣出訊號要求
"minSignalCountToSell": 1  // 從 2 降到 1

// 降低超買門檻
"rsi": {
  "overbought": 70  // 從 75 降到 70
}
```

### 4. 如果想更激進恐慌買入

```json
"panic": {
  "minDropRank": 3,           // 從 2 改為 3（大跌20%就觸發）
  "rsiDivider": 1.3,          // 從 1.6 降到 1.3（RSI<31即可）
  "suggestedLeverage": 0.4    // 從 30% 提高到 40%
}
```

---

## ⚠️ 風險提示

### 1. 維持率安全線

```
建議維持率層級：
━━━━━━━━━━━━━━━
> 180%：✅ 安全（可大額加碼）
160-180%：⚠️ 中等（小額加碼）
140-160%：❌ 危險（禁止加碼）
< 140%：🚨 追繳風險（補保證金）
```

**建議**：實際操作時留 20% 緩衝（系統 140% → 實際建議 168%）

### 2. 跳空保護

**隔日開盤前檢查**：
```
今日收盤：169.5 元
安全區間：164.4 ~ 174.6 元（±3%）

若開盤 > 174.6 → ❌ 取消買入（避免追高）
若開盤 < 164.4 → ⚠️ 謹慎評估（可能有風險）
若開盤在區間內 → ✅ 執行昨晚決策
```

### 3. 不適用情境

❌ **本策略不適用**：
- 當沖交易
- 盤中套利
- 高頻交易
- 市場開盤前 9:00 前決策（資料尚未更新）

✅ **適用情境**：
- 中長期趨勢跟蹤
- 收盤後決策（14:30 後）
- 定期定額 + 逢低加碼
- 波段持有（數週到數月）

---

## 📅 每日使用流程

### ⏰ 自動執行時間

本系統採用「收盤後決策 + 開盤前提醒」雙重通知機制：

| 執行時間 | 台灣時間 | UTC 時間 | 執行內容 | 通知目的 |
|:---|:---:|:---:|:---|:---|
| **收盤後分析** | 14:40 | 06:40 | 📊 完整決策分析 | 產生明日操作建議 |
| **開盤前提醒** | 08:30 | 00:30 | ⏰ 讀取昨晚決策 | 提醒準備執行 |

**GitHub Actions 設定**：
```yaml
schedule:
  - cron: '40 6 * * 1-5'    # 收盤後（台灣 14:40）
  - cron: '30 0 * * 1-5'    # 開盤前（台灣 08:30）
```

---

### 📊 第一次通知：收盤後分析（14:40）

#### 系統自動執行
```bash
# GitHub Actions 自動觸發
# 執行時間：台灣時間 14:40（UTC 06:40）
```

**執行內容**：
1. ✅ 抓取今日收盤資料（TWSE STOCK_DAY API）
2. ✅ 計算所有技術指標（RSI/KD/MACD/MA240/Bias）
3. ✅ 評估投資決策（buy/sell/hold）
4. ✅ 計算風控指標（維持率/00675L佔比）
5. ✅ 產生完整決策建議
6. ✅ 發送 LINE 通知

#### 通知內容
```
📊 [收盤後決策] 2026-02-03

🏹 市場狀態：📈【轉多/可加碼】
🎯 操作建議：積極型（50%）

💰 明日操作：
建議增貸至 50% 加碼

📈 技術指標：
━━━━━━━━━━━━━━━
RSI: 45
KD: 35 (低檔)
MACD: 黃金交叉 ✔️
VIX: 19.2
維持率: 182%
00675L佔比: 35%

📊 評分詳情：
━━━━━━━━━━━━━━━
跌幅 12% → 3分
RSI 反轉 → 3分
MACD 交叉 → 2分
━━━━━━━━━━━━━━━
總分：8分 → 積極型

⏰ 明日 08:30 將再次提醒您
```

#### 你該做的事（15:00-23:00）

**檢查決策合理性**：
- ✅ **市場狀態判斷**：是否過熱、轉弱、恐慌？
- ✅ **技術指標確認**：RSI/KD 是否在預期區間？
- ✅ **風控狀況檢視**：維持率 > 160%？佔比是否正常？
- ✅ **評分邏輯檢查**：為何得到這個分數？是否合理？

**決定隔日行動**：
```
如果建議「買入」：
  → ✅ 確認券商帳戶餘額充足
  → ✅ 計畫買入金額（建議分2-3批）
  → ✅ 設定鬧鐘 08:25（開盤前5分鐘）

如果建議「觀察」：
  → 👀 不操作，繼續觀察

如果建議「賣出」：
  → 💸 確認 00675L 持有數量
  → 💸 計畫賣出金額
```

**特別注意**：
- 🔥 如果是「恐慌加碼」→ 務必確認維持率充足（> 160%）
- 🚫 如果是「禁撥款」→ 0050照常定投，00675L暫停
- ⚠️ 如果維持率 < 160% → 即使建議買入也應謹慎

---

### ⏰ 第二次通知：開盤前提醒（08:30）

#### 系統自動執行
```bash
# GitHub Actions 自動觸發
# 執行時間：台灣時間 08:30（UTC 00:30）
```

**執行內容**：
1. ✅ 讀取昨晚決策結果（不重新計算）
2. ✅ 抓取 00675L 最新價格（前一交易日收盤）
3. ✅ 計算跳空警示區間（±3%）
4. ✅ 發送簡化提醒通知

#### 通知內容
```
⏰ [開盤前提醒] 2026-02-04

📍 昨日決策：📈 積極型（50%）
💰 建議操作：增貸 50% 加碼

📊 昨日收盤價：169.5 元
✅ 安全區間：164.4 ~ 174.6 元（±3%）

⚠️ 開盤檢查清單：
━━━━━━━━━━━━━━━
□ 09:05 查看開盤價
□ 確認是否在安全區間內
□ 若跳空 > ±3% 需重新評估
□ 分批買入（建議 2-3 次）

🔔 距離開盤還有 30 分鐘
```

#### 你該做的事（08:30-09:00）

**開盤前準備**：
- ✅ **打開券商 APP**
- ✅ **檢查帳戶餘額**
- ✅ **複習昨晚決策**
- ✅ **準備下單介面**

**心理準備**：
```
買入決策：
  → 😌 提醒自己：這是收盤後冷靜分析的結果
  → 🧘 不因盤前氛圍改變決策
  → ⚠️ 唯一變數：開盤跳空幅度

觀察決策：
  → 👀 今日不操作
  → 🚫 不因開盤走勢臨時起意
```

---

### 📱 隔日開盤後執行（09:05-09:15）

#### 跳空檢查流程

```
步驟 1：查看 00675L 開盤價
  ↓
步驟 2：計算跳空幅度
  跳空% = (開盤價 - 昨收) / 昨收 × 100%
  ↓
步驟 3：對照安全區間（昨晚通知中的範圍）
  ↓
步驟 4：決定是否執行
```

#### 決策矩陣（買入決策）

| 開盤價 vs 昨收 | 跳空幅度 | 執行動作 | 理由 |
|:---|:---:|:---|:---|
| 164.4 ~ 174.6 | ±3% 內 | ✅ **執行昨晚決策** | 價格在預期範圍 |
| > 174.6 | > +3% | ❌ **取消買入** | 跳空追高，等回檔 |
| < 164.4 | < -3% | ⚠️ **分情況處理** | 見下方說明 |

**跳空下跌處理邏輯**：
```
IF 昨晚決策 == "💰 恐慌加碼"
  → ✅ 繼續執行（更便宜了！千載難逢）
ELSE IF 昨晚決策 == "📈 積極型" OR "🛡️ 定期定額"
  → ⚠️ 謹慎評估（可能有負面消息，建議觀察盤中走勢）
  → 可考慮延後至 10:00 再決定，或減少買入金額
```

#### 決策矩陣（賣出決策）

| 開盤價 vs 昨收 | 跳空幅度 | 執行動作 | 理由 |
|:---|:---:|:---|:---|
| > +3% | 跳空上漲 | ✅ **繼續執行** | 更好的賣出價格 |
| ±3% 內 | 正常 | ✅ **執行昨晚決策** | 按計畫賣出 |
| < -3% | 跳空下跌 | ❌ **取消賣出** | 避免殺低，等反彈 |

---

### 📋 實際操作範例

#### 範例 A：正常買入（跳空在安全範圍內）

```
【收盤後 14:40 通知】
昨日收盤：169.5 元
決策：📈 積極型（50%）
評分：8 分

【開盤前 08:30 提醒】
昨日收盤：169.5 元
安全區間：164.4 ~ 174.6 元

【隔日 09:05 執行】
今日開盤：172.0 元
跳空幅度：+1.5%（在安全區間內）
→ ✅ 執行買入
→ 分 3 批買入：09:05、10:00、11:00
```

---

#### 範例 B：跳空過大取消買入

```
【收盤後 14:40 通知】
昨日收盤：169.5 元
決策：📈 積極型（50%）
評分：8 分

【開盤前 08:30 提醒】
昨日收盤：169.5 元
安全區間：164.4 ~ 174.6 元

【隔日 09:05 檢查】
今日開盤：177.8 元
跳空幅度：+4.9%（超過上限）
→ ❌ 取消買入（避免追高）
→ 今日觀察，等待回檔
```

---

#### 範例 C：恐慌買入遇跳空下跌

```
【收盤後 14:40 通知】
昨日收盤：28.5 元
決策：💰 恐慌加碼（30%）
評分：11 分（跌幅 32%、RSI 22、VIX 33）

【開盤前 08:30 提醒】
昨日收盤：28.5 元
安全區間：27.6 ~ 29.3 元
特別提示：恐慌買入訊號，跳空下跌可繼續執行

【隔日 09:05 執行】
今日開盤：27.0 元
跳空幅度：-5.3%（跌破下限）
→ ✅ 繼續執行（恐慌買入邏輯）
→ 價格更便宜，分 2 批買入
→ 務必確認維持率 > 160%
```

---

#### 範例 D：停利賣出遇跳空上漲

```
【收盤後 14:40 通知】
昨日收盤：65.2 元
決策：💸 停利/降槓桿
漲幅：+85%，賣出訊號 2 個

【開盤前 08:30 提醒】
昨日收盤：65.2 元
安全區間：63.2 ~ 67.2 元

【隔日 09:05 執行】
今日開盤：68.5 元
跳空幅度：+5.1%（超過上限）
→ ✅ 繼續執行（賣出價格更好）
→ 分 2 批賣出，立即還款
```

---

### 🚨 特殊情況處理

#### 情況 A：錯過開盤時段（09:30 後才看到）

```
處理步驟：
1. 立即查看目前價格
2. 計算與昨收的偏離幅度
3. 判斷：
   - 偏離 < ±5% → 可於 10:00 前執行
   - 偏離 > ±5% → 放棄本次，等明日
   - 如果是恐慌買入 → 偏離 -10% 內都可考慮
```

#### 情況 B：連續兩天未收到通知

```
可能原因：
1. GitHub Actions 故障
2. LINE 通知 Token 過期
3. 資料來源 API 異常

處理方式：
→ 手動執行：npm start
→ 檢查 GitHub Actions 執行紀錄
→ 檢查 LINE Token 是否有效
```

#### 情況 C：收盤後通知正常，開盤前未收到提醒

```
處理方式：
→ 回頭查看昨晚 14:40 的通知
→ 自行計算跳空區間（昨收 × 0.97 ~ 昨收 × 1.03）
→ 按原計畫執行
```

#### 情況 D：盤中臨時想查看狀態

```
手動執行：
→ GitHub: Actions → Run workflow → Run manually
→ 或本地執行：npm start

注意：
⚠️ 盤中執行會使用昨日資料（今日尚未收盤）
⚠️ 技術指標可能與盤後不同
⚠️ 僅供參考，不建議作為決策依據
```

---

### 🔄 完整時間軸（標準流程）

```
【D 日（交易日）】
09:00 ─────────── 開盤
13:30 ─────────── 收盤
14:30 ─────────── TWSE 資料更新
14:40 ─────────── 🤖 第一次通知（收盤後分析）
15:00-23:00 ────── 👤 你查看通知，決定明日行動

【D+1 日（隔日）】
08:30 ─────────── 🤖 第二次通知（開盤前提醒）
08:30-09:00 ────── 👤 準備下單
09:00 ─────────── 開盤
09:05 ─────────── 👤 查看開盤價，判斷跳空
09:05-09:15 ────── 👤 執行下單（第一批）
10:00 ─────────── 👤 執行下單（第二批，可選）
11:00 ─────────── 👤 執行下單（第三批，可選）
```

---

### ✅ 執行檢查清單（每日）

#### 收盤後（14:40）
```
□ 收到 LINE 通知
□ 確認市場狀態判斷合理
□ 檢查技術指標數值
□ 確認風控指標（維持率/佔比）
□ 理解評分邏輯
□ 決定明日操作策略
□ 設定 08:25 鬧鐘（可選）
```

#### 開盤前（08:30）
```
□ 收到 LINE 提醒
□ 複習昨晚決策
□ 記住安全區間範圍
□ 打開券商 APP
□ 檢查帳戶餘額
□ 準備下單介面
□ 保持冷靜心態
```

#### 開盤後（09:05）
```
□ 查看 00675L 開盤價
□ 計算跳空幅度
□ 對照安全區間
□ 決定是否執行：
  □ 買入決策 + 跳空 > +3% → 取消
  □ 買入決策 + 跳空 < -3% → 評估
  □ 買入決策 + 跳空 ±3% → 執行
  □ 賣出決策 + 跳空 > +3% → 執行
  □ 賣出決策 + 跳空 < -3% → 取消
□ 分批下單（建議 2-3 次）
□ 記錄實際執行價格
```

---

### 💡 使用心得與建議

#### 雙重通知的優勢
1. ✅ **收盤後有充足時間思考**：不必盤中倉促決策
2. ✅ **開盤前再次提醒**：避免忘記執行
3. ✅ **跳空保護機制**：避免追高殺低
4. ✅ **決策與執行分離**：提高決策品質

#### 常見誤區
1. ❌ **開盤前臨時改變決策**
   - 除非出現極端跳空，否則應執行昨晚決策
   - 盤前氛圍容易誤導判斷

2. ❌ **跳空稍微超過 3% 就硬要執行**
   - 設定 3% 門檻是有原因的
   - 寧可錯過機會，不要追高

3. ❌ **單筆全部買入**
   - 建議分 2-3 批，降低買在高點風險
   - 09:05、10:00、11:00 各買 1/3

4. ❌ **恐慌時不敢買，貪婪時追高**
   - 系統叫你買（恐慌）時通常是低點
   - 系統叫你觀察（過熱）時通常要謹慎

---

### 🎯 成功使用的關鍵

1. **紀律執行**：信任系統的收盤後決策，不被盤前情緒影響
2. **跳空保護**：嚴格遵守 ±3% 規則
3. **分批買入**：降低單點風險
4. **風控優先**：維持率 < 160% 時一律停止加碼
5. **長期視角**：單次錯過不重要，重要的是整體策略正確

記住：**這是趨勢跟蹤策略，不是預測系統**。系統幫你避免情緒干擾，做出理性決策。
```

***

---

## 🔧 常見問題

### Q1: 為什麼分數明明達標但還是建議觀察？

**A**: 可能觸發「過熱」或「轉弱」機制，優先級高於進場評分。檢查：
- 過熱因子是否 >= 2？（RSI>82, KD>85, Bias>35%）
- 轉弱訊號是否 >= 3？

### Q2: 恐慌買入為什麼沒觸發？

**A**: 需同時滿足 3 個條件：
```
✅ 跌幅 >= 30%（第2高級別）
✅ RSI < 25（40/1.6）
✅ VIX >= 28
```
缺一不可。

### Q3: 如何判斷今天該不該買？

**A**: 看 LINE 通知的「市場狀態」：
- 🔥/📈/🛡️ → 可買入（檢查跳空）
- 👀/🌡️ → 觀察不買
- 🚫/📉 → 禁止買入
- 💸/⚖️ → 賣出操作

### Q4: 跳空 +3.5% 該取消買入嗎？

**A**: 是的。建議規則：
- 買入決策：跳空 > +3% → 取消（避免追高）
- 賣出決策：跳空 > +3% → 繼續（更好價格）

### Q5: 可以盤中執行決策嗎？

**A**: 不建議。原因：
- 技術指標基於收盤價計算
- 盤中價格會持續變動
- 容易受情緒干擾

**建議**：收盤後決策品質更高。

---

## 📚 技術指標計算說明

### RSI（相對強弱指標）

```
RSI = 100 - (100 / (1 + RS))
RS = 平均上漲幅度 / 平均下跌幅度（14日）

超賣：< 40
中性：40-70
超買：> 70
```

### KD（隨機指標）

```
RSV = (收盤價 - 9日最低) / (9日最高 - 9日最低) * 100
K = 2/3 前K + 1/3 RSV
D = 2/3 前D + 1/3 K

超賣：< 20
超買：> 80
```

### MACD（指數平滑異同移動平均線）

```
DIF = EMA(12) - EMA(26)
DEA = EMA(DIF, 9)
柱狀圖 = DIF - DEA

黃金交叉：DIF 上穿 DEA
死亡交叉：DIF 下穿 DEA
```

### 年線乖離率（Bias240）

```
Bias240 = (收盤價 - MA240) / MA240 * 100

低估：< 0%
正常：0-15%
偏貴：15-25%
過熱：> 25%
```

---

## 📝 變更記錄

### v1.0.0（2026-02-03）
- ✅ 初始版本
- ✅ 完整決策邏輯
- ✅ 評分制進場系統
- ✅ 恐慌買入機制
- ✅ 多層次風控
- ✅ 配置驅動設計

---

## 📄 授權

本專案僅供個人投資參考，不構成投資建議。投資有風險，請謹慎評估。

---

## 💡 提示

**記住**：
1. ✅ 這是趨勢跟蹤策略，不是預測系統
2. ✅ 收盤後決策比盤中追價品質更高
3. ✅ 跳空保護是必要的（避免追高殺低）
4. ✅ 維持率是生命線（低於 160% 停止加碼）
5. ✅ 分批買入比一次梭哈更安全

**祝投資順利！** 🚀
